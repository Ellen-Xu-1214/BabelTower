{"ast":null,"code":"import _toConsumableArray from \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/src/views/Tables.js\";\nimport React from \"react\";\nimport { Container, Row } from \"shards-react\";\nimport PageTitle from \"../components/common/PageTitle\";\nimport { Form, Upload, message, Button, Icon } from 'antd';\n\nvar AliyunOSSUpload =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AliyunOSSUpload, _React$Component);\n\n  function AliyunOSSUpload() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AliyunOSSUpload);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AliyunOSSUpload)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      OSSData: {}\n    };\n    _this.init =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var OSSData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _this.mockGetOSSData();\n\n            case 3:\n              OSSData = _context.sent;\n\n              _this.setState({\n                OSSData: OSSData\n              });\n\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              message.error(_context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    _this.mockGetOSSData = function () {\n      return {\n        dir: 'user-dir/',\n        expire: '1577811661',\n        host: '//www.mocky.io/v2/5cc8019d300000980a055e76',\n        accessId: 'c2hhb2RhaG9uZw==',\n        policy: 'eGl4aWhhaGFrdWt1ZGFkYQ==',\n        signature: 'ZGFob25nc2hhbw=='\n      };\n    };\n\n    _this.onChange = function (_ref2) {\n      var fileList = _ref2.fileList;\n      var onChange = _this.props.onChange;\n      console.log('Aliyun OSS:', fileList);\n\n      if (onChange) {\n        onChange(_toConsumableArray(fileList));\n      }\n    };\n\n    _this.onRemove = function (file) {\n      var _this$props = _this.props,\n          value = _this$props.value,\n          onChange = _this$props.onChange;\n      var files = value.filter(function (v) {\n        return v.url !== file.url;\n      });\n\n      if (onChange) {\n        onChange(files);\n      }\n    };\n\n    _this.transformFile = function (file) {\n      var OSSData = _this.state.OSSData;\n      var suffix = file.name.slice(file.name.lastIndexOf('.'));\n      var filename = Date.now() + suffix;\n      file.url = OSSData.dir + filename;\n      return file;\n    };\n\n    _this.getExtraData = function (file) {\n      var OSSData = _this.state.OSSData;\n      return {\n        key: file.url,\n        OSSAccessKeyId: OSSData.accessId,\n        policy: OSSData.policy,\n        Signature: OSSData.signature\n      };\n    };\n\n    _this.beforeUpload =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var OSSData, expire;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              OSSData = _this.state.OSSData;\n              expire = OSSData.expire * 1000;\n\n              if (!(expire < Date.now())) {\n                _context2.next = 5;\n                break;\n              }\n\n              _context2.next = 5;\n              return _this.init();\n\n            case 5:\n              return _context2.abrupt(\"return\", true);\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _this;\n  }\n\n  _createClass(AliyunOSSUpload, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.init();\n\n              case 2:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var value = this.props.value;\n      var props = {\n        name: 'file',\n        fileList: value,\n        action: this.state.OSSData.host,\n        onChange: this.onChange,\n        onRemove: this.onRemove,\n        transformFile: this.transformFile,\n        data: this.getExtraData,\n        beforeUpload: this.beforeUpload\n      };\n      return React.createElement(Upload, Object.assign({}, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }), React.createElement(Button, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        type: \"upload\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }), \" Click to Upload\"));\n    }\n  }]);\n\n  return AliyunOSSUpload;\n}(React.Component);\n\nvar FormPage =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(FormPage, _React$Component2);\n\n  function FormPage() {\n    _classCallCheck(this, FormPage);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(FormPage).apply(this, arguments));\n  }\n\n  _createClass(FormPage, [{\n    key: \"render\",\n    value: function render() {\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      return React.createElement(Form, {\n        onSubmit: this.handleSubmit,\n        labelCol: {\n          span: 4\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, React.createElement(Form.Item, {\n        label: \"Photos\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, getFieldDecorator('photos')(React.createElement(AliyunOSSUpload, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return FormPage;\n}(React.Component);\n\nvar WrappedFormPage = Form.create()(FormPage);\n\nvar Tables = function Tables() {\n  return React.createElement(Container, {\n    fluid: true,\n    className: \"main-content-container px-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, React.createElement(Row, {\n    noGutters: true,\n    className: \"page-header py-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, React.createElement(PageTitle, {\n    sm: \"4\",\n    title: \"Materials\",\n    subtitle: \"Resource\",\n    className: \"text-sm-left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  })), React.createElement(WrappedFormPage, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }));\n};\n\nexport default Tables;","map":{"version":3,"sources":["/Users/junlinghu/Desktop/Fall 2019/Software Engineering/Shards-Dashboard-Lite-React-1.0.0/Source Files/src/views/Tables.js"],"names":["React","Container","Row","PageTitle","Form","Upload","message","Button","Icon","AliyunOSSUpload","state","OSSData","init","mockGetOSSData","setState","error","dir","expire","host","accessId","policy","signature","onChange","fileList","props","console","log","onRemove","file","value","files","filter","v","url","transformFile","suffix","name","slice","lastIndexOf","filename","Date","now","getExtraData","key","OSSAccessKeyId","Signature","beforeUpload","action","data","Component","FormPage","getFieldDecorator","form","handleSubmit","span","WrappedFormPage","create","Tables"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Container, Row} from \"shards-react\";\n\nimport PageTitle from \"../components/common/PageTitle\";\nimport { Form, Upload, message, Button, Icon } from 'antd';\n\nclass AliyunOSSUpload extends React.Component {\n  state = {\n    OSSData: {},\n  };\n\n  async componentDidMount() {\n    await this.init();\n  }\n\n  init = async () => {\n    try {\n      const OSSData = await this.mockGetOSSData();\n\n      this.setState({\n        OSSData,\n      });\n    } catch (error) {\n      message.error(error);\n    }\n  };\n\n  // Mock get OSS api\n  // https://help.aliyun.com/document_detail/31988.html\n  mockGetOSSData = () => {\n    return {\n      dir: 'user-dir/',\n      expire: '1577811661',\n      host: '//www.mocky.io/v2/5cc8019d300000980a055e76',\n      accessId: 'c2hhb2RhaG9uZw==',\n      policy: 'eGl4aWhhaGFrdWt1ZGFkYQ==',\n      signature: 'ZGFob25nc2hhbw==',\n    };\n  };\n\n  onChange = ({ fileList }) => {\n    const { onChange } = this.props;\n    console.log('Aliyun OSS:', fileList);\n    if (onChange) {\n      onChange([...fileList]);\n    }\n  };\n\n  onRemove = file => {\n    const { value, onChange } = this.props;\n\n    const files = value.filter(v => v.url !== file.url);\n\n    if (onChange) {\n      onChange(files);\n    }\n  };\n\n  transformFile = file => {\n    const { OSSData } = this.state;\n\n    const suffix = file.name.slice(file.name.lastIndexOf('.'));\n    const filename = Date.now() + suffix;\n    file.url = OSSData.dir + filename;\n\n    return file;\n  };\n\n  getExtraData = file => {\n    const { OSSData } = this.state;\n\n    return {\n      key: file.url,\n      OSSAccessKeyId: OSSData.accessId,\n      policy: OSSData.policy,\n      Signature: OSSData.signature,\n    };\n  };\n\n  beforeUpload = async () => {\n    const { OSSData } = this.state;\n    const expire = OSSData.expire * 1000;\n\n    if (expire < Date.now()) {\n      await this.init();\n    }\n    return true;\n  };\n\n  render() {\n    const { value } = this.props;\n    const props = {\n      name: 'file',\n      fileList: value,\n      action: this.state.OSSData.host,\n      onChange: this.onChange,\n      onRemove: this.onRemove,\n      transformFile: this.transformFile,\n      data: this.getExtraData,\n      beforeUpload: this.beforeUpload,\n    };\n    return (\n      <Upload {...props}>\n        <Button>\n          <Icon type=\"upload\" /> Click to Upload\n        </Button>\n      </Upload>\n    );\n  }\n}\n\nclass FormPage extends React.Component {\n  render() {\n    const { getFieldDecorator } = this.props.form;\n    return (\n      <Form onSubmit={this.handleSubmit} labelCol={{ span: 4 }}>\n        <Form.Item label=\"Photos\">{getFieldDecorator('photos')(<AliyunOSSUpload />)}</Form.Item>\n      </Form>\n    );\n  }\n}\n\nconst WrappedFormPage = Form.create()(FormPage);\n\nconst Tables = () => (\n  <Container fluid className=\"main-content-container px-4\">\n    {/* Page Header */}\n    <Row noGutters className=\"page-header py-4\">\n      <PageTitle sm=\"4\" title=\"Materials\" subtitle=\"Resource\" className=\"text-sm-left\" />\n    </Row>\n\n    <WrappedFormPage />\n\n  </Container>\n);\n\nexport default Tables;\n"]},"metadata":{},"sourceType":"module"}